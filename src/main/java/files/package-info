Общая архитектура
Классы FileReader и FileWriter реализуют паттерн Dependency Injection для чтения/записи данных о городах.

Они работают с файлами формата "Название города | население | год основания":
Москва | 12655050 | 1147
Санкт-Петербург | 5384342 | 1703

FileReader
Читает текстовый файл построчно, валидирует строки, парсит данные и создает объекты City.

Зависимости (инжектируются через конструктор):
LineParser parser - парсит строку в Map{name, population, year}
LineCounter counter - считает строки (обработанные/ошибки)
ErrorLogger logger - логирует ошибки

Алгоритм работы readFile():
1. Проверка пути к файлу (FileUtils.isValidPath)
2. Files.lines() → Stream<String>
3. processLines():
   • counter.incrementLine() для каждой строки
   • FileUtils.isValidLineFormat() → фильтр
   • parser.parseLine() → Map<String,String>
   • CityDirector.converter() → CityBuilder → City
   • Null-объекты отбрасываются (filter)
4. CityArrayListCollector.toCityArrayList()
5. printResultMessage() если printResults=true
6. counter.reset()

Особенности
Try-with-resources гарантирует закрытие Stream
Peek для подсчета валидных строк без нарушения потока
Null-safety через Objects.requireNonNull и filter(Objects::nonNull)
Equals/hashCode только по parser (ключевой компонент)

FileWriter - Запись данных
Добавляет данные городов в конец существующего файла или создает новый.

Зависимость
ErrorLogger logger - логирует ошибки записи

Алгоритм работы write():
1. checkAndCreateFile():
   • Проверка .txt расширения
   • Files.createDirectories() для родительских папок
   • Files.createFile() если файла нет
2. Files.newBufferedWriter(CREATE|APPEND|WRITE)
3. Если файл не пустой → пишет разделитель:
   ------Добавление данных-------
4. cityList → CitySerializer.serialize() → forEach:
   • writer.write(line)
   • count.increment() или logger.logError()
5. printResultMessage() показывает статистику

Особенности
APPEND mode сохраняет старые данные
LongAdder для thread-safe подсчета
CREATE|APPEND|WRITE опции для надежности
Автоматическое создание директорий

Пример использования:
LineParser parser = new LineParser();
LineCounter counter = new LineCounter();
ErrorLogger logger = new ErrorLogger();
FileReader reader = new FileReader(parser, counter, logger);
CityArrayList<City> cities = reader.readFile(Path.of("input.txt"), true)
FileWriter writer = new FileWriter(logger);
writer.write(Path.of("output.txt"), cities, true);